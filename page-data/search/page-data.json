{"componentChunkName":"component---src-pages-search-jsx","path":"/search/","result":{"data":{"allMarkdownRemark":{"nodes":[{"excerpt":"환경 로컬환경 M1 MacBook Pro Docker version 27.2.0 Dockerfile Image: node:14-alpine EC2환경 Amazon Linux Docker version  25.0.5 64bit x86 / arm Option t2.micro 발생한 에러 로컬환경에서 빌드한 이미지를 Docker Hub에 push 한 뒤 EC2…","fields":{"slug":"/M1-EC2-Docker-ErrorHandling/"},"frontmatter":{"date":"October 13, 2024","title":"M1 맥북으로 EC2 배포 시 오류","tags":["Docker","AWS","EC2","삽질"]},"rawMarkdownBody":"\n## 환경\n\n로컬환경\n- M1 MacBook Pro\n- Docker version 27.2.0\n- Dockerfile Image: node:14-alpine\n\nEC2환경\n- Amazon Linux\n- Docker version  25.0.5\n- 64bit x86 / arm Option\n- t2.micro\n\n## 발생한 에러\n\n로컬환경에서 빌드한 이미지를 Docker Hub에 push 한 뒤 EC2에 컨테이너를 수동으로 배포하는데 다음과 같은 error가 발생했습니다.\n\n![Error Log](ERROR_LOG.png)\n\n**WARNING: The requested image's platform (linux/arm64/v8) does not match the detected host platform (linux/amd64/v3) and no specific platform was requested**\n\nWARNING: The requested image's platform does not match the detected host platform and no specific platform was requested\n\n## 해결 방법\n\n해당 오류는 M1 맥북으로 빌드한 이미지 플랫폼(linux/arm64/v8)과 제가 선택한 EC2의 플랫폼(linux/amd64)이 맞지 않아 발생했습니다.\n\n이를 해결하기 위해 이미지 빌드 시 `--platform` 옵션을 사용하여 빌드했습니다.\n\n```bash\n$ docker build --platform linux/amd64 -t [ImageName] .\n```\n\n## 추가로 생각해본 것\n\n지금은 EC2의 Error Log에 맞게 플랫폼 옵션을 사용했지만 Multi-Platform을 지원하기 위해 다음과 같이 빌드하기도 합니다.\n\n```bash\n$ docker build --platform linux/amd64, linux/arm64 .\n```\n\n로컬환경에서 빌드 -> Docker Hub에 push -> EC2에서 pull 받아 다시 배포했습니다.\n\n## 주의할 점\n\n도커는 컨테이너 실행 시 도커 명령어를 실행한 로컬에서 먼저 이미지를 찾고, 없으면 Docker Hub에서 찾습니다. 이 말인즉슨 이미 로컬에 이미지가 존재한다면 기존 이미지를 사용할 것입니다.\n그래서 기존 이미지를 지운 다음 다시 실행했습니다.\n\n![](IMAGE_2.png)\n\n[REF]\n\n[docker docs](https://docs.docker.com/build/building/multi-platform/)\n"}]}},"pageContext":{}},"staticQueryHashes":[],"slicesMap":{}}