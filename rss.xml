<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[RSS Feed of seokulee]]></title><description><![CDATA[Hello :) I'm Seokkyu. I'm studying data engineering and data science. I'm also interested in web development.]]></description><link>https://seokulee.github.io</link><generator>GatsbyJS</generator><lastBuildDate>Tue, 15 Oct 2024 12:27:03 GMT</lastBuildDate><item><title><![CDATA[[Docker] M1 맥북으로 EC2 배포 시 오류]]></title><description><![CDATA[환경 로컬환경 M1 MacBook Pro Docker version 27.2.0 Dockerfile Image: node:14-alpine EC2환경 Amazon Linux Docker version  25.0.5 64bit x86 / arm…]]></description><link>https://seokulee.github.io/M1-EC2-Docker-ErrorHandling/</link><guid isPermaLink="false">https://seokulee.github.io/M1-EC2-Docker-ErrorHandling/</guid><pubDate>Sun, 13 Oct 2024 00:00:00 GMT</pubDate><content:encoded>&lt;h2 id=&quot;환경&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%99%98%EA%B2%BD&quot; aria-label=&quot;환경 permalink&quot; class=&quot;heading-anchor before&quot;&gt;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;15&quot; height=&quot;15&quot; viewBox=&quot;0 0 24 24&quot;&gt;&lt;path d=&quot;M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z&quot;/&gt;&lt;/svg&gt;&lt;/a&gt;환경&lt;/h2&gt;
&lt;p&gt;로컬환경&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;M1 MacBook Pro&lt;/li&gt;
&lt;li&gt;Docker version 27.2.0&lt;/li&gt;
&lt;li&gt;Dockerfile Image: node:14-alpine&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;EC2환경&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Amazon Linux&lt;/li&gt;
&lt;li&gt;Docker version  25.0.5&lt;/li&gt;
&lt;li&gt;64bit x86 / arm Option&lt;/li&gt;
&lt;li&gt;t2.micro&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;발생한-에러&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B0%9C%EC%83%9D%ED%95%9C-%EC%97%90%EB%9F%AC&quot; aria-label=&quot;발생한 에러 permalink&quot; class=&quot;heading-anchor before&quot;&gt;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;15&quot; height=&quot;15&quot; viewBox=&quot;0 0 24 24&quot;&gt;&lt;path d=&quot;M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z&quot;/&gt;&lt;/svg&gt;&lt;/a&gt;발생한 에러&lt;/h2&gt;
&lt;p&gt;로컬환경에서 빌드한 이미지를 Docker Hub에 push 한 뒤 EC2에 컨테이너를 수동으로 배포하는데 다음과 같은 error가 발생했습니다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&apos;gatsby-resp-image-figure&apos; style=&apos;margin-bottom: 16px;&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; &apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/1262d1c9d3fa844a653b790fbd0752f5/0a739/ERROR_LOG.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 21.176470588235293%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAlklEQVR42o2PSQ6DMBAEeU1C2My+GZnFYFBCFin/f0vHM5GiHDmUeqYPNbbTz3covaNRBrLf0KoVZashsg5JoRClLbyohBvkh3CW6xvj8gCJq27h8hIWnGc/w8lL4do8LDR/wlJqlpCQXkXQTFB/BGcyTxbq7YXRzv28Y7C7mm7f79sjWT1A5BJBXDNh0jC+qH5dEDecH0y6gRsw46nWAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;Error Log&apos; title=&apos;&apos; src=&apos;/static/1262d1c9d3fa844a653b790fbd0752f5/ca1dc/ERROR_LOG.png&apos; srcset=&apos;/static/1262d1c9d3fa844a653b790fbd0752f5/e7570/ERROR_LOG.png 170w,
/static/1262d1c9d3fa844a653b790fbd0752f5/f46e7/ERROR_LOG.png 340w,
/static/1262d1c9d3fa844a653b790fbd0752f5/ca1dc/ERROR_LOG.png 680w,
/static/1262d1c9d3fa844a653b790fbd0752f5/02d09/ERROR_LOG.png 1020w,
/static/1262d1c9d3fa844a653b790fbd0752f5/9d567/ERROR_LOG.png 1360w,
/static/1262d1c9d3fa844a653b790fbd0752f5/0a739/ERROR_LOG.png 2638w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&apos;gatsby-resp-image-figcaption&apos;&gt;Error Log&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;WARNING: The requested image&apos;s platform (linux/arm64/v8) does not match the detected host platform (linux/amd64/v3) and no specific platform was requested&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;WARNING: The requested image&apos;s platform does not match the detected host platform and no specific platform was requested&lt;/p&gt;
&lt;h2 id=&quot;해결-방법&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95&quot; aria-label=&quot;해결 방법 permalink&quot; class=&quot;heading-anchor before&quot;&gt;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;15&quot; height=&quot;15&quot; viewBox=&quot;0 0 24 24&quot;&gt;&lt;path d=&quot;M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z&quot;/&gt;&lt;/svg&gt;&lt;/a&gt;해결 방법&lt;/h2&gt;
&lt;p&gt;해당 오류는 M1 맥북으로 빌드한 이미지 플랫폼(linux/arm64/v8)과 제가 선택한 EC2의 플랫폼(linux/amd64)이 맞지 않아 발생했습니다.&lt;/p&gt;
&lt;p&gt;이를 해결하기 위해 이미지 빌드 시 &lt;code class=&quot;language-text&quot;&gt;--platform&lt;/code&gt; 옵션을 사용하여 빌드했습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; build &lt;span class=&quot;token parameter variable&quot;&gt;--platform&lt;/span&gt; linux/amd64 &lt;span class=&quot;token parameter variable&quot;&gt;-t&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;ImageName&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;추가로-생각해본-것&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%B6%94%EA%B0%80%EB%A1%9C-%EC%83%9D%EA%B0%81%ED%95%B4%EB%B3%B8-%EA%B2%83&quot; aria-label=&quot;추가로 생각해본 것 permalink&quot; class=&quot;heading-anchor before&quot;&gt;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;15&quot; height=&quot;15&quot; viewBox=&quot;0 0 24 24&quot;&gt;&lt;path d=&quot;M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z&quot;/&gt;&lt;/svg&gt;&lt;/a&gt;추가로 생각해본 것&lt;/h2&gt;
&lt;p&gt;지금은 EC2의 Error Log에 맞게 플랫폼 옵션을 사용했지만 Multi-Platform을 지원하기 위해 다음과 같이 빌드하기도 합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; build &lt;span class=&quot;token parameter variable&quot;&gt;--platform&lt;/span&gt; linux/amd64, linux/arm64 &lt;span class=&quot;token builtin class-name&quot;&gt;.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;로컬환경에서 빌드 -&gt; Docker Hub에 push -&gt; EC2에서 pull 받아 다시 배포했습니다.&lt;/p&gt;
&lt;h2 id=&quot;주의할-점&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A3%BC%EC%9D%98%ED%95%A0-%EC%A0%90&quot; aria-label=&quot;주의할 점 permalink&quot; class=&quot;heading-anchor before&quot;&gt;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;15&quot; height=&quot;15&quot; viewBox=&quot;0 0 24 24&quot;&gt;&lt;path d=&quot;M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z&quot;/&gt;&lt;/svg&gt;&lt;/a&gt;주의할 점&lt;/h2&gt;
&lt;p&gt;도커는 컨테이너 실행 시 도커 명령어를 실행한 로컬에서 먼저 이미지를 찾고, 없으면 Docker Hub에서 찾습니다. 이 말인즉슨 이미 로컬에 이미지가 존재한다면 기존 이미지를 사용할 것입니다.
그래서 기존 이미지를 지운 다음 다시 실행했습니다.&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/f75a7c7ff5d189d1efed9de5b27d900f/0a739/IMAGE_2.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 33.529411764705884%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAAA6klEQVR42o2R6W6CUBCFfZmqRQUKLkgviOwgINa4Jn3/xzidOwRT4xJ+nJy7fpkz01tHFfykvmkVlhDrHK6/YVlOhLntQzMF9KlDElDUOYZjkzR9UM8NCkT5Hml5REyeFAf2jPZJeUC+PfO9hCjqgv1zMnsKY6CsKqtOBDjR5wuvN+TF7sqwav/LZ/LxYGSyXsEY6FFE719sLyqxdGMIL4MlQoobYLb031Z1B5Q9lD37JkAbp6nEQF8x8DHUyb86wRgYZj88CNnLFthK7se6hZG26A7kqHGNIK3h0FQbNVO2Vyk0mqxq2J2BfxLC5xqI1c3RAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;IMAGE 2&apos; title=&apos;&apos; src=&apos;/static/f75a7c7ff5d189d1efed9de5b27d900f/ca1dc/IMAGE_2.png&apos; srcset=&apos;/static/f75a7c7ff5d189d1efed9de5b27d900f/e7570/IMAGE_2.png 170w,
/static/f75a7c7ff5d189d1efed9de5b27d900f/f46e7/IMAGE_2.png 340w,
/static/f75a7c7ff5d189d1efed9de5b27d900f/ca1dc/IMAGE_2.png 680w,
/static/f75a7c7ff5d189d1efed9de5b27d900f/02d09/IMAGE_2.png 1020w,
/static/f75a7c7ff5d189d1efed9de5b27d900f/9d567/IMAGE_2.png 1360w,
/static/f75a7c7ff5d189d1efed9de5b27d900f/0a739/IMAGE_2.png 2638w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos; decoding=&apos;async&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;[REF]&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.docker.com/build/building/multi-platform/&quot;&gt;docker docs&lt;/a&gt;&lt;/p&gt;</content:encoded></item></channel></rss>